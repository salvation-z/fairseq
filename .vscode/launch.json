{
    // 使用 IntelliSense 了解相关属性。 
    // 悬停以查看现有属性的描述。
    // 欲了解更多信息，请访问: https://go.microsoft.com/fwlink/?linkid=830387
    "version": "0.2.0",
    "configurations": [
        // Launch setting for evaluation
        // Change it for every task
        {
            "name":"Python: generate",
            "type":"python",
            "request":"launch",
            "program":"/home5/zhangzhuocheng/lab/pos_graph/fairseq/generate.py",
            "console":"integratedTerminal",
            "cwd": "${workspaceFolder}",
            "args": [
                "data-bin/iwslt14.tokenized.de-en",
                "--path", "checkpoints/checkpoint_best.pt",
                "--batch-size", "128",
                "--beam", "5",
                "--remove-bpe"
            ]
        },
        
        // Launch setting for data preprocess
        // Change it for every new datasets
        // To be changed:
        // 1. DataPath
        {
            "name": "Python: preprocess",
            "type": "python",
            "request": "launch",
            "env": {
                "DataPath": "/home5/zhangzhuocheng/lab/pos_graph"
            },
            "program": "/home5/zhangzhuocheng/lab/pos_graph/fairseq/preprocess.py",
            "console": "integratedTerminal",
            "args": [
                "--trainpref", "datasets/train.tok.clean.bpe.32000",
                "--validpref", "datasets/newstest2016.tok.bpe.32000",
                "--testpref", "datasets/newstest2015.tok.bpe.32000,datasets/newstest2014.tok.bpe.32000,datasets/newstest2013.tok.bpe.32000,datasets/newstest2012.tok.bpe.32000,datasets/newstest2011.tok.bpe.32000,datasets/newstest2010.tok.bpe.32000,datasets/newstest2009.tok.bpe.32000", 
                "--source-lang", "en", 
                "--target-lang", "de",
                "--destdir", "data-bin", 
                "--joined-dictionary",
                "--workers", "16"
            ]   
        },

        // Launch setting for data preprocess
        // Change it for every new datasets
        // To be changed:
        // 1. DataPath
        {
            "name": "Python: preprocess tiny",
            "type": "python",
            "request": "launch",
            "env": {
                "DataPath": "/home5/zhangzhuocheng/lab/pos_graph"
            },
            "program": "/home5/zhangzhuocheng/lab/pos_graph/fairseq/preprocess.py",
            "console": "integratedTerminal",
            "args": [
                "--trainpref", "datasets/tiny_raw/train.tok.clean.bpe.32000",
                "--validpref", "datasets/tiny_raw/newstest2016.tok.bpe.32000",
                "--testpref", "datasets/tiny_raw/newstest2015.tok.bpe.32000,datasets/tiny_raw/newstest2014.tok.bpe.32000,datasets/tiny_raw/newstest2013.tok.bpe.32000,datasets/tiny_raw/newstest2012.tok.bpe.32000,datasets/tiny_raw/newstest2011.tok.bpe.32000,datasets/tiny_raw/newstest2010.tok.bpe.32000,datasets/tiny_raw/newstest2009.tok.bpe.32000", 
                "--source-lang", "en", 
                "--target-lang", "de",
                "--destdir", "datasets/tiny-bin", 
                "--joined-dictionary",
                "--workers", "16"
            ]   
        },

        // Launch setting for training
        // Change this before running
        // To be changed:
        // 1. CUDA_VISIBLE_DEVICES
        // 2. Dataset path
        // 3. save_dir
        {
            "name": "Python: en_de translate",
            "type": "python",
            "request": "launch",
            "program": "/home5/zhangzhuocheng/lab/pos_graph/fairseq/train.py",
            "console": "integratedTerminal",
            "cwd": "${workspaceFolder}",
            "env": {"CUDA_VISIBLE_DEVICES": "0,1,2,3"},
            "args": [
                "/home5/zhangzhuocheng/lab/pos_graph/datasets/data-bin",
                "--task", "pos_translation",
                "--arch", "gnn_transformer_base",
                "--save-dir", "/home5/zhangzhuocheng/lab/pos_graph/models/pos_base/",
                "--optimizer", "adam",
                "--adam-betas", "(0.9, 0.98)",
                "--clip-norm", "0.0",
                "--lr", "7e-4",
                "--lr-scheduler", "inverse_sqrt",
                "--warmup-updates", "4000",
                "--warmup-init-lr", "1e-07",
                "--min-lr","1e-09",
                "--dropout", "0.1",
                "--weight-decay", "0.0001",
                "--criterion", "label_smoothed_cross_entropy",
                "--label-smoothing", "0.1",
                "--max-tokens", "4096",
                "--update-freq", "2",
                "--log-format", "json",
                "--log-interval", "100",
                "--save-interval-updates", "1000",
                "--max-update", "150000",
                "--keep-interval-updates", "5",
                "--keep-last-epochs", "5",
                "--eval-bleu",
                "--eval-bleu-args", "{\"beam\": 5, \"max_len_a\": 1.2, \"max_len_b\": 10}",
                "--eval-bleu-detok:", "moses",
                "--eval-bleu-remove-bpe",
                "--eval-bleu-print-samples", 
                "--best-checkpoint-metric", "bleu"
            ]
        },
        
        // Launch setting for training
        // Change this before running
        // To be changed:
        // 1. CUDA_VISIBLE_DEVICES
        // 2. Dataset path
        // 3. save_dir
        {
            "name": "Python: translate tiny",
            "type": "python",
            "request": "launch",
            "program": "/home5/zhangzhuocheng/lab/pos_graph/fairseq/train.py",
            "console": "integratedTerminal",
            "cwd": "${workspaceFolder}",
            "env": {"CUDA_VISIBLE_DEVICES": "-1"},
            "args": [
                "/home5/zhangzhuocheng/lab/pos_graph/datasets/tiny-bin",
                "--task", "pos_translation",
                "--arch", "gcn_transformer",
                "--save-dir", "/home5/zhangzhuocheng/lab/pos_graph/models/pos_base/",
                "--optimizer", "adam",
                "--adam-betas", "(0.9, 0.98)",
                "--clip-norm", "0.0",
                "--lr", "7e-4",
                "--lr-scheduler", "inverse_sqrt",
                "--warmup-updates", "4000",
                "--warmup-init-lr", "1e-07",
                "--min-lr","1e-09",
                "--dropout", "0.1",
                "--weight-decay", "0.0001",
                "--criterion", "label_smoothed_cross_entropy",
                "--label-smoothing", "0.1",
                "--max-tokens", "1024",
                "--update-freq", "8",
                "--max-update", "1500",
                "--eval-bleu",
                "--eval-bleu-args", "{\"beam\": 5, \"max_len_a\": 1.2, \"max_len_b\": 10}",
                "--eval-bleu-detok", "moses",
                "--eval-bleu-remove-bpe",
                "--eval-bleu-print-samples", 
                "--best-checkpoint-metric", "bleu",
                "--debug-mode"
            ]
        },

        // Default launch setting of vscode
        // Runing the code you wanted without any arguments
        {
            "name": "Python: default",
            "type": "python",
            "request": "launch",
            "program": "${file}",
            "console": "integratedTerminal"
        },
    ]
}